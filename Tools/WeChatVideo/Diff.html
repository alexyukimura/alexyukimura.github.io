<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <title>ÁÅ´ÁúºÈáëÁùõÊåëÊàòÔºöÊâæÂá∫‰∏çÂêåÊ±âÂ≠óÔºÅ‰Ω†ËÉΩÂá†ÁßíÂÆåÊàêÔºü</title>
    <style>
        :root {
            --cell-bg: #fff;
            --cell-border: #b0c4de;
            --cell-text: #2d3a4b;
            --cell-hover-bg: #d0e6fa;
            --cell-hover-text: #e94f4a;
            --cell-shadow: #d0d0d0;
            --cell-hover-shadow: #b0c4de;
        }
        html {
            font-size: 16px;
        }
        body {
            font-family: "ÂæÆËΩØÈõÖÈªë", Arial, sans-serif;
            background: #f2f6f9;
            text-align: center;
            margin: 0;
            padding: 0;
            transition: background-color 0.5s ease;
        }
        #main-title {
            margin-top: 2.5rem;
            font-size: 2.4rem;
            font-weight: bold;
            letter-spacing: 3px;
            padding: 0 1rem;
            word-break: break-all;
            background: linear-gradient(45deg, #ff6b6b, #4a90e2, #ffb300);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGradient 3s ease infinite, titleGlow 2s infinite alternate;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            position: relative;
            display: inline-block;
        }
        #main-title::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #ff6b6b, #4a90e2, transparent);
            border-radius: 3px;
            animation: titleLine 3s ease infinite;
        }
        @keyframes titleGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes titleGlow {
            0% { filter: drop-shadow(0 0 2px rgba(233, 79, 74, 0.3)); }
            50% { filter: drop-shadow(0 0 8px rgba(74, 144, 226, 0.6)); }
            100% { filter: drop-shadow(0 0 2px rgba(255, 179, 0, 0.3)); }
        }
        @keyframes titleLine {
            0% { opacity: 0.3; transform: translateX(-50%) scaleX(0.8); }
            50% { opacity: 1; transform: translateX(-50%) scaleX(1); }
            100% { opacity: 0.3; transform: translateX(-50%) scaleX(0.8); }
        }
        #timer-tip-wrap {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 1.2rem;
            margin-bottom: 0.5rem;
            gap: 1.2rem;
        }
        .timer-wrap {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            position: relative;
        }
        .timer-icon {
            width: 2.8rem;
            height: 2.8rem;
            background: linear-gradient(135deg, #fff 0%, #f0f4f8 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(176, 196, 222, 0.4),
                        inset 0 -2px 4px rgba(0, 0, 0, 0.05);
            animation: float 2s ease-in-out infinite;
            font-size: 1.5rem;
            position: relative;
            transition: transform 0.3s ease;
        }
        .timer-icon::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, #4a90e2, #357abd);
            border-radius: 50%;
            z-index: -1;
            opacity: 0.2;
            animation: pulse 2s ease-in-out infinite;
        }
        .timer-icon:hover {
            transform: scale(1.1);
        }
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0); }
            50% { transform: translateY(-5px) rotate(5deg); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.2; }
            50% { transform: scale(1.1); opacity: 0.3; }
        }
        #timer {
            font-size: 1.3rem;
            color: #357abd;
            font-weight: bold;
            letter-spacing: 1px;
            display: inline-block;
            vertical-align: middle;
            background: linear-gradient(135deg, #fff 0%, #f0f4f8 100%);
            border-radius: 0.7rem;
            padding: 0.4rem 1.2rem;
            box-shadow: 0 4px 12px rgba(176, 196, 222, 0.4),
                        inset 0 -2px 4px rgba(0, 0, 0, 0.05);
            position: relative;
            transition: transform 0.3s ease;
        }
        #timer:hover {
            transform: translateY(-2px);
        }
        #find-tip {
            display: inline-block;
            font-size: 1.25rem;
            color: #fff;
            background: linear-gradient(90deg, #ffb300 60%, #ff5252 100%);
            font-weight: bold;
            border-radius: 1.2rem;
            padding: 0.5rem 1.6rem;
            box-shadow: 0 4px 16px #ffd60099;
            letter-spacing: 2px;
            vertical-align: middle;
            text-shadow: 1px 1px 8px #ffecb3, 0 2px 8px #e94f4a;
            border: 2.5px solid #fffbe6;
            margin: 0;
            overflow: hidden;
        }
        #find-tip span {
            display: inline-block;
            animation: scale 1.5s infinite ease-in-out;
        }
        .find-tip-movein {
            animation: moveInRight 0.7s cubic-bezier(.68,-0.55,.27,1.55);
        }
        @keyframes moveInRight {
            0% { transform: translateX(120%); opacity: 0; }
            80% { transform: translateX(-8%); opacity: 1; }
            100% { transform: translateX(0); opacity: 1; }
        }
        @keyframes scale {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        #game-board {
            display: inline-block;
            margin: 2rem auto 0 auto;
            border: 2px solid #4a90e2;
            background: #e3eaf2;
            border-radius: 1rem;
            box-shadow: 0 2px 16px #b0c4de;
            padding: 1.2rem 0.5rem 0.8rem 0.5rem;
            max-width: 98vw;
            transition: all 0.5s ease;
        }
        .row {
            display: flex;
            justify-content: center;
        }
        .cell {
            width: 2.4rem;
            height: 2.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            border: 1.5px solid var(--cell-border);
            cursor: pointer;
            background: var(--cell-bg);
            color: var(--cell-text);
            margin: 0.15rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 1px 4px var(--cell-shadow);
            user-select: none;
        }
        .cell:hover, .cell:active {
            background: var(--cell-hover-bg);
            color: var(--cell-hover-text);
            box-shadow: 0 2px 8px var(--cell-hover-shadow);
        }
        .center-btn {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #restart {
            margin-top: 1.2rem;
            margin-bottom: 0.5rem;
            padding: 0.8rem 2.2rem;
            font-size: 1.1rem;
            background: #4a90e2;
            color: #fff;
            border: none;
            border-radius: 0.6rem;
            cursor: pointer;
            box-shadow: 0 2px 8px #b0c4de;
            font-weight: bold;
            letter-spacing: 2px;
            transition: background 0.2s;
            display: inline-block;
        }
        #restart:hover, #restart:active {
            background: #357abd;
        }
        #popup {
            display: none;
            position: fixed;
            left: 50%;
            top: 40%;
            transform: translate(-50%, -50%);
            background: #fffbe6;
            color: #e94f4a;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 1rem;
            box-shadow: 0 4px 32px #b0c4de;
            padding: 1.5rem 2.2rem;
            z-index: 9999;
            animation: popupShow 0.5s;
            max-width: 90vw;
            word-break: break-all;
        }
        @keyframes popupShow {
            0% { opacity: 0; transform: scale(0.7) translate(-50%, -50%);}
            100% { opacity: 1; transform: scale(1) translate(-50%, -50%);}
        }
        #header-container {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 1.2rem;
            padding: 0 0.5rem;
            margin-top: 1.2rem;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        #camera-container {
            position: relative;
            width: 80px;
            height: 60px;
            background: #000;
            border-radius: 0.6rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            z-index: 100;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #main-title {
            font-size: 1.3rem;
            letter-spacing: 1px;
            margin: 0;
            text-align: left;
            min-width: 0;
            flex: 1;
        }
        #camera-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: #000;
        }
        #camera-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 0.4rem;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #camera-container:hover #camera-controls {
            opacity: 1;
        }
        .camera-btn {
            width: 1.8rem;
            height: 1.8rem;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: all 0.2s ease;
        }
        .camera-btn:hover {
            transform: scale(1.1);
            background: #fff;
        }
        .camera-btn:active {
            transform: scale(0.95);
        }
        @media (max-width: 1200px) {
            #header-container {
                flex-direction: column;
                gap: 1rem;
            }
            #camera-container {
                width: 240px;
                height: 180px;
            }
        }
        @media (max-width: 600px) {
            html { 
                font-size: 16px; 
            }
            #header-container {
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
                padding: 0 0.2rem;
                margin-top: 0.6rem;
            }
            #camera-container {
                width: 60px;
                height: 45px;
                border-radius: 0.4rem;
            }
            #main-title {
                font-size: 1.05rem;
                text-align: center;
            }
            #timer-tip-wrap {
                flex-direction: column;
                gap: 0.5rem;
                margin-top: 0.8rem;
                margin-bottom: 0.3rem;
            }
            .timer-wrap {
                gap: 0.5rem;
            }
            .timer-icon {
                width: 2rem;
                height: 2rem;
                font-size: 1.1rem;
            }
            #timer {
                font-size: 1rem;
                padding: 0.3rem 0.8rem;
            }
            #find-tip {
                font-size: 0.95rem;
                padding: 0.3rem 0.8rem;
                border-radius: 0.8rem;
                letter-spacing: 1px;
            }
            #game-board { 
                padding: 0.8rem 0.2rem;
                margin-top: 1rem;
                max-width: 92vw;
            }
            .cell { 
                width: 2rem; 
                height: 2rem; 
                font-size: 1.4rem;
                margin: 0.1rem;
                border-radius: 0.4rem;
            }
            #camera-container {
                width: 120px;
                height: 90px;
                border-radius: 0.6rem;
            }
            .camera-btn {
                width: 1.4rem;
                height: 1.4rem;
                font-size: 0.8rem;
            }
            #camera-controls {
                padding: 0.3rem;
                gap: 0.3rem;
            }
            #restart { 
                font-size: 1.1rem; 
                padding: 0.8rem 1.6rem;
                margin-top: 1rem;
                margin-bottom: 0.3rem;
            }
            #popup { 
                font-size: 1.2rem; 
                padding: 1.2rem 1.6rem;
                max-width: 85vw;
            }
        }

        /* ÈíàÂØπË∂ÖÂ∞èÂ±èÂπïÁöÑ‰ºòÂåñ */
        @media (max-width: 360px) {
            html { 
                font-size: 14px; 
            }
            #main-title {
                font-size: 1.2rem;
            }
            .cell { 
                width: 1.8rem; 
                height: 1.8rem; 
                font-size: 1.2rem;
            }
            #camera-container {
                width: 100px;
                height: 75px;
            }
        }
    </style>
</head>
<body>
    <div id="header-container">
        <div id="camera-container"></div>
        <h1 id="main-title">ÁÅ´ÁúºÈáëÁùõÊåëÊàòÔºöÊâæÂá∫‰∏çÂêåÊ±âÂ≠óÔºÅ‰Ω†ËÉΩÂá†ÁßíÂÆåÊàêÔºü</h1>
    </div>
    <div id="timer-tip-wrap">
        <div class="timer-wrap">
            <div class="timer-icon">‚è±Ô∏è</div>
            <div id="timer">Áî®Êó∂Ôºö0.00 Áßí</div>
        </div>
        <span id="find-tip">ÊâæÂá∫Âõæ‰∏≠"<span>Èí±</span>"</span>
    </div>
    <div id="game-board"></div>
    <div class="center-btn">
        <button id="restart" onclick="startGame()">ÈáçÊñ∞ÂºÄÂßã</button>
    </div>
    <div id="popup"></div>
    
    <!-- ÂÖàÂä†ËΩΩÂ≠óÂ∫ì -->
    <script src="./charPairs.js"></script>
    
    <!-- ÁÑ∂ÂêéÂä†ËΩΩÊ∏∏ÊàèÈÄªËæë -->
    <script>
        // Á°Æ‰øùÂ≠óÂ∫ìÂ∑≤Âä†ËΩΩ
        if (!window.charPairs || !window.charPairs.length) {
            console.error('Â≠óÂ∫ìÂä†ËΩΩÂ§±Ë¥•ÔºÅ');
            document.getElementById('popup').textContent = 'Ê∏∏ÊàèÂàùÂßãÂåñÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï';
            document.getElementById('popup').style.display = 'block';
            throw new Error('Â≠óÂ∫ìÂä†ËΩΩÂ§±Ë¥•');
        }

        const gridSize = 8;
        let normalChar = "ÁõÆ";
        let diffChar = "Êó•";
        let timerInterval = null;
        let startTime = null;
        let timerStopped = false;

        // ÊüîÂíåËÉåÊôØËâ≤
        const backgroundColors = [
            '#f2f6f9', '#f5f5f0', '#f0f4f8', '#f8f4f0', '#f0f8f4', '#f4f0f8', '#fff8f0', '#f0f8f8'
        ];
        // ÂØπÂ∫îËæπÊ°ÜËâ≤
        const borderColors = [
            '#4a90e2', '#8e44ad', '#27ae60', '#e67e22', '#c0392b', '#16a085', '#d35400', '#2980b9'
        ];
        // ÊüîÂíåÊ†ºÂ≠êÂ∫ïËâ≤
        const cellBgColors = [
            '#fff', '#f9f6f2', '#f6fff2', '#f2f6ff', '#f2fff6', '#fff6f2', '#f6f2ff', '#fffaf2'
        ];
        // Ê†ºÂ≠êËæπÊ°ÜËâ≤
        const cellBorderColors = [
            '#b0c4de', '#d0c4e0', '#b0e0c4', '#e0c4b0', '#e0b0b0', '#b0e0d0', '#e0d0b0', '#b0d0e0'
        ];
        // Ê†ºÂ≠êÊñáÂ≠óËâ≤
        const cellTextColors = [
            '#2d3a4b', '#3a2d4b', '#2d4b3a', '#4b3a2d', '#4b2d2d', '#2d4b4b', '#4b4b2d', '#2d3a4b'
        ];
        // Ê†ºÂ≠êÊÇ¨ÂÅúËÉåÊôØËâ≤
        const cellHoverBgColors = [
            '#d0e6fa', '#e6d0fa', '#d0fae6', '#fae6d0', '#fad0d0', '#d0fafa', '#fafad0', '#d0e6fa'
        ];
        // Ê†ºÂ≠êÊÇ¨ÂÅúÊñáÂ≠óËâ≤
        const cellHoverTextColors = [
            '#e94f4a', '#9f4ae9', '#4ae994', '#e9944a', '#e94a4a', '#4ae9e9', '#e9e94a', '#4a94e9'
        ];
        // Ê†ºÂ≠êÈò¥ÂΩ±Ëâ≤
        const cellShadowColors = [
            '#d0d0d0', '#e0d0e0', '#d0e0d0', '#e0d0d0', '#e0d0d0', '#d0e0e0', '#e0e0d0', '#d0d0e0'
        ];
        // Ê†ºÂ≠êÊÇ¨ÂÅúÈò¥ÂΩ±Ëâ≤
        const cellHoverShadowColors = [
            '#b0c4de', '#c4b0de', '#b0dec4', '#dec4b0', '#deb0b0', '#b0dede', '#dedeb0', '#b0c4de'
        ];

        let bestTime = localStorage.getItem('bestTime') || Infinity;
        let achievementUnlocked = false;

        function getRandomInt(max) {
            return Math.floor(Math.random() * max);
        }

        function updateBackgroundColor() {
            const index = getRandomInt(backgroundColors.length);
            const randomColor = backgroundColors[index];
            const randomBorderColor = borderColors[index];
            
            // Êõ¥Êñ∞ËÉåÊôØËâ≤
            document.body.style.backgroundColor = randomColor;
            
            // Êõ¥Êñ∞Ê∏∏ÊàèÂå∫ÂüüÊ†∑Âºè
            const board = document.getElementById('game-board');
            board.style.borderColor = randomBorderColor;
            board.style.boxShadow = `0 2px 16px ${randomBorderColor}40`;
            board.style.background = `${randomColor}dd`;
            
            // Êõ¥Êñ∞CSSÂèòÈáè
            document.documentElement.style.setProperty('--cell-bg', cellBgColors[index]);
            document.documentElement.style.setProperty('--cell-border', cellBorderColors[index]);
            document.documentElement.style.setProperty('--cell-text', cellTextColors[index]);
            document.documentElement.style.setProperty('--cell-hover-bg', cellHoverBgColors[index]);
            document.documentElement.style.setProperty('--cell-hover-text', cellHoverTextColors[index]);
            document.documentElement.style.setProperty('--cell-shadow', cellShadowColors[index]);
            document.documentElement.style.setProperty('--cell-hover-shadow', cellHoverShadowColors[index]);
        }

        function startTimer() {
            startTime = Date.now();
            timerStopped = false;
            document.getElementById('timer').textContent = 'Áî®Êó∂Ôºö0.00 Áßí';
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                if (timerStopped) return;
                const elapsed = (Date.now() - startTime) / 1000;
                document.getElementById('timer').textContent = `Áî®Êó∂Ôºö${elapsed.toFixed(2)} Áßí`;
            }, 50);
        }

        function stopTimer() {
            timerStopped = true;
            if (timerInterval) clearInterval(timerInterval);
        }

        function showPopup(msg) {
            const popup = document.getElementById('popup');
            popup.textContent = msg;
            popup.style.display = 'block';
            setTimeout(() => {
                popup.style.display = 'none';
            }, 1800);
        }

        function startGame() {
            try {
                document.getElementById('game-board').innerHTML = '';
                updateBackgroundColor();

                // ÈöèÊú∫ÈÄâÊã©‰∏ÄÁªÑÊ±âÂ≠ó
                const pair = window.charPairs[getRandomInt(window.charPairs.length)];
                if (!pair || pair.length !== 2) {
                    throw new Error('Êó†ÊïàÁöÑÊ±âÂ≠óÂØπ');
                }
                normalChar = pair[0];
                diffChar = pair[1];

                // Âä®ÊÄÅÊõ¥Êñ∞ÊèêÁ§∫ÂÜÖÂÆπÂπ∂Âä†Âè≥‰æßÁßªÂÖ•Âä®Áîª
                const findTip = document.getElementById('find-tip');
                if (findTip) {
                    findTip.innerHTML = `ÊâæÂá∫Âõæ‰∏≠"<span>${diffChar}</span>"`;
                    findTip.classList.remove('find-tip-movein');
                    // Ëß¶ÂèëÈáçÁªò
                    void findTip.offsetWidth;
                    findTip.classList.add('find-tip-movein');
                }

                // ÈöèÊú∫ÁîüÊàê‰∏çÂêåÂ≠óÁöÑ‰ΩçÁΩÆ
                const diffRow = getRandomInt(gridSize);
                const diffCol = getRandomInt(gridSize);

                startTimer();

                for (let i = 0; i < gridSize; i++) {
                    const rowDiv = document.createElement('div');
                    rowDiv.className = 'row';
                    for (let j = 0; j < gridSize; j++) {
                        const cell = document.createElement('div');
                        cell.className = 'cell';
                        cell.textContent = (i === diffRow && j === diffCol) ? diffChar : normalChar;
                        cell.onclick = function() {
                            if (timerStopped) return;
                            if (i === diffRow && j === diffCol) {
                                handleGameWin();
                            }
                        };
                        rowDiv.appendChild(cell);
                    }
                    document.getElementById('game-board').appendChild(rowDiv);
                }
            } catch (error) {
                console.error('Ê∏∏ÊàèÂàùÂßãÂåñÂ§±Ë¥•:', error);
                showPopup('Ê∏∏ÊàèÂàùÂßãÂåñÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï');
            }
        }

        function handleGameWin() {
            const currentTime = (Date.now() - startTime) / 1000;
            stopTimer();
            if (currentTime < bestTime) {
                bestTime = currentTime;
                localStorage.setItem('bestTime', bestTime);
                showPopup('üéâ Êñ∞Á∫™ÂΩïÔºÅ‰Ω†ÊòØÊúÄÂø´ÁöÑÔºÅ');
            }
            let message = '';
            if (currentTime < 8) {
                message = 'Â§™ÂéâÂÆ≥‰∫ÜÔºÅ‰Ω†ÊòØÁÅ´ÁúºÈáëÁùõÔºÅ';
            } else if (currentTime < 15) {
                message = '‰∏çÈîôÔºÅ‰Ω†ÁöÑÁúºÂäõÂæàÂ•ΩÔºÅ';
            } else {
                message = 'ÁªßÁª≠Âä†Ê≤πÔºÅ';
            }
            showPopup(message);
        }

        // Á≠âÂæÖÈ°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂêØÂä®Ê∏∏Êàè
        window.onload = function() {
            try {
                startGame();
            } catch (error) {
                console.error('Ê∏∏ÊàèÂêØÂä®Â§±Ë¥•:', error);
                showPopup('Ê∏∏ÊàèÂêØÂä®Â§±Ë¥•ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï');
            }
        };
    </script>
</body>
</html>